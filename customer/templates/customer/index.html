{% include 'customer/base.html'%}
{% block content %}
<main>

<section id="welcome-section" class="container" style="padding-top:2em">
  <div class="row">
  <div class="col-5">
          <h4 style="font-family: 'fantasy', cursive;color: #357EC7; size:15px" class="text-center">My Tickets ({{tickets|length }})</h4>
  </div>
  <div class="col-1">

  </div>
  <div class="col-2">

  </div>
  <div class="col-4">
    <span style="float:right; display:block;">  <form class="form-inline my-2 my-lg-0" role="search" action="{% url 'search_results' %}">
                  <input class="form-control mr-sm-2" type="search" placeholder="Search For Ticket" aria-label="Search" name="ticket">
              </form></span>
  </div>
  </div>

    <div class="row mt-2">

        <table class="table table-primary">
          <thead class="thead-primary">
            <tr>
              <th scope="col">#</th>
              <th scope="col">Title</th>
              <th scope="col">Date Created</th>
              <th scope="col">Last Updated</th>
              <th scope="col">Status</th>
              <th scope="col">Ticket Number</th>
            </tr>
          </thead>
          <tbody>
              {% for ticket in tickets %}
            <tr>
              <th scope="row">{{ticket.id}}</th>

              <td><a data-toggle="modal" href="#{{ticket.id}}{{ticket.owner.username}}">{{ticket.issue}}</a></td>
              <td>{{ticket.date_created }}</td>
              <td>{{ticket.last_updated }}</td>
              <td>{{ticket.get_status_display}}</td>
              <td>{{ticket.ticket_number}}</td>
            </tr>
            {% endfor %}
          </tbody>
        </table>


    </div>
    {% for ticket in tickets  %}
    <div class="row mt-2">

<!-- Modal -->
<div class="modal fade" id="{{ticket.id}}{{ticket.owner.username}}" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h6 class="modal-title" id="exampleModalLabel">{{ticket.issue |upper}}</h6>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
         <div class="card card-body">
           <h5>Edited By:</h5>
           <li class="list-group">
             <li class="list-group-item">Agent: {{ticket.agent.username}}</li>
             <li class="list-group-item">Last Updated: {{ticket.last_updated |date:"D, d M ,Y"}}</li>
             <li class="list-group-item">Time: {{ticket.last_updated |date:"H:i"}}</li>
           </li>
         </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-primary" data-dismiss="modal">Close</button>
        </div>
      </div>
    </div>
  </div>

    </div>

    {% endfor %}
</section>
</main>
<style>
/* Style the main content */
main {
  margin-left: 200px; /* Same as the width of the sidenav */
  padding: 0px 10px;
}</style>
{% endblock  %}
